<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Weather App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* ================= Body & Container ================= */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #74ebd5, #acb6e5);
      min-height: 100vh;
    }

    .container {
      max-width: 900px;
      margin: auto;
      padding: 20px;
    }

    /* ================= Heading ================= */
    h1 {
      text-align: center;
      color: #fff;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    /* ================= Input Section ================= */
    .weather-input {
      background: rgba(255, 255, 255, 0.9);
      padding: 20px;
      margin-top: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .weather-input input {
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      flex: 1;
      min-width: 200px;
    }

    .weather-input button {
      padding: 10px 20px;
      border-radius: 6px;
      border: none;
      background-color: #0288d1;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .weather-input button:hover {
      background-color: #026ca0;
    }

    /* ================= Weather Data Section ================= */
    .weather-data {
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      margin-top: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    /* ================= Weather Cards ================= */
    .weather-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      padding: 0;
      list-style: none;
      margin-top: 20px;
    }

    .card {
      flex: 1 1 150px; /* responsive width */
      background: #e3f2fd;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 15px rgba(0,0,0,0.2);
    }

    /* ================= Card Elements ================= */
    .card h3 {
      margin: 10px 0 5px 0;
      font-size: 1.2rem;
      color: #0277bd;
    }

    .card p, .card h6 {
      margin: 5px 0;
      color: #555;
    }

    .card .temperature {
      font-size: 2rem;
      font-weight: bold;
      color: #01579b;
    }

    .card img {
      width: 60px;
      margin-bottom: 10px;
    }

    /* ================= Responsive Design ================= */
    @media (max-width: 600px) {
      .weather-input {
        flex-direction: column;
        gap: 10px;
      }

      .weather-cards {
        flex-direction: column;
      }

      .card {
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Weather Dashboard</h1>
  <div class="container">
    <div class="weather-input">
      <h3>Enter a City Name</h3>
      <input class="city-input" type="text" placeholder="E.g., New York, London, Tokyo">
      <button class="search-btn">Search</button>
      <div class="separator"></div>
      <button class="location-btn">Use Current Location</button>
    </div>
    <div class="weather-data">
      <div class="current-weather">
        <div class="details">
          <h2>(City)</h2>
          <h6>Temperature: °C</h6>
          <h6>Wind: m/s</h6>
          <h6>Humidity: %</h6>
        </div>
      </div>
      <div class="days-forecast">
        <h2>5-Day Forecast</h2>
        <ul class="weather-cards">
          <li class="card">
            <h3>(Day)</h3>
            <h6>Temp: °C</h6>
            <h6>Wind: m/s</h6>
            <h6>Humidity: %</h6>
          </li>
          <li class="card">
            <h3>(Day)</h3>
            <h6>Temp: °C</h6>
            <h6>Wind: m/s</h6>
            <h6>Humidity: %</h6>
          </li>
          <li class="card">
            <h3>(Day)</h3>
            <h6>Temp: °C</h6>
            <h6>Wind: m/s</h6>
            <h6>Humidity: %</h6>
          </li>
          <li class="card">
            <h3>(Day)</h3>
            <h6>Temp: °C</h6>
            <h6>Wind: m/s</h6>
            <h6>Humidity: %</h6>
          </li>
          <li class="card">
            <h3>(Day)</h3>
            <h6>Temp: °C</h6>
            <h6>Wind: m/s</h6>
            <h6>Humidity: %</h6>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    const cityInput = document.querySelector(".city-input");
    const searchButton = document.querySelector(".search-btn");
    const locationButton = document.querySelector(".location-btn");
    const currentWeatherDiv = document.querySelector(".current-weather");
    const weatherCardsDiv = document.querySelector(".weather-cards");

    const API_KEY = "4e325da782b8023febe3fe27047a57a1"; // API key for OpenWeatherMap API

    const createWeatherCard = (cityName, weatherItem, index) => {
        if(index === 0) { 
            return `<div class="details">
                        <h2>${cityName} (${weatherItem.dt_txt.split(" ")[0]})</h2>
                        <h6>Temperature: ${(weatherItem.main.temp - 273.15).toFixed(2)}°C</h6>
                        <h6>Wind: ${weatherItem.wind.speed} M/S</h6>
                        <h6>Humidity: ${weatherItem.main.humidity}%</h6>
                    </div>
                    <div class="icon">
                        <img src="https://openweathermap.org/img/wn/${weatherItem.weather[0].icon}@4x.png" alt="weather-icon">
                        <h6>${weatherItem.weather[0].description}</h6>
                    </div>`;
        } else {
            return `<li class="card">
                        <h3>(${weatherItem.dt_txt.split(" ")[0]})</h3>
                        <img src="https://openweathermap.org/img/wn/${weatherItem.weather[0].icon}@4x.png" alt="weather-icon">
                        <h6>Temp: ${(weatherItem.main.temp - 273.15).toFixed(2)}°C</h6>
                        <h6>Wind: ${weatherItem.wind.speed} M/S</h6>
                        <h6>Humidity: ${weatherItem.main.humidity}%</h6>
                    </li>`;
        }
    }

    const getWeatherDetails = (cityName, latitude, longitude) => {
        const WEATHER_API_URL = `https://api.openweathermap.org/data/2.5/forecast?lat=${latitude}&lon=${longitude}&appid=${API_KEY}`;

        fetch(WEATHER_API_URL).then(response => response.json()).then(data => {
            const uniqueForecastDays = [];
            const fiveDaysForecast = data.list.filter(forecast => {
                const forecastDate = new Date(forecast.dt_txt).getDate();
                if (!uniqueForecastDays.includes(forecastDate)) {
                    return uniqueForecastDays.push(forecastDate);
                }
            });

            cityInput.value = "";
            currentWeatherDiv.innerHTML = "";
            weatherCardsDiv.innerHTML = "";

            fiveDaysForecast.forEach((weatherItem, index) => {
                const html = createWeatherCard(cityName, weatherItem, index);
                if (index === 0) {
                    currentWeatherDiv.insertAdjacentHTML("beforeend", html);
                } else {
                    weatherCardsDiv.insertAdjacentHTML("beforeend", html);
                }
            });        
        }).catch(() => {
            alert("An error occurred while fetching the weather forecast!");
        });
    }

    const getCityCoordinates = () => {
        const cityName = cityInput.value.trim();
        if (cityName === "") return;
        const API_URL = `https://api.openweathermap.org/geo/1.0/direct?q=${cityName}&limit=1&appid=${API_KEY}`;
        
        fetch(API_URL).then(response => response.json()).then(data => {
            if (!data.length) return alert(`No coordinates found for ${cityName}`);
            const { lat, lon, name } = data[0];
            getWeatherDetails(name, lat, lon);
        }).catch(() => {
            alert("An error occurred while fetching the coordinates!");
        });
    }

    const getUserCoordinates = () => {
        navigator.geolocation.getCurrentPosition(
            position => {
                const { latitude, longitude } = position.coords;
                const API_URL = `https://api.openweathermap.org/geo/1.0/reverse?lat=${latitude}&lon=${longitude}&limit=1&appid=${API_KEY}`;
                fetch(API_URL).then(response => response.json()).then(data => {
                    const { name } = data[0];
                    getWeatherDetails(name, latitude, longitude);
                }).catch(() => {
                    alert("An error occurred while fetching the city name!");
                });
            },
            error => {
                if (error.code === error.PERMISSION_DENIED) {
                    alert("Geolocation request denied. Please reset location permission to grant access again.");
                } else {
                    alert("Geolocation request error. Please reset location permission.");
                }
            });
    }

    locationButton.addEventListener("click", getUserCoordinates);
    searchButton.addEventListener("click", getCityCoordinates);
    cityInput.addEventListener("keyup", e => e.key === "Enter" && getCityCoordinates());
  </script>
</body>
</html>
